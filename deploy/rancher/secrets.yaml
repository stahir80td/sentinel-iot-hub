# HomeGuard IoT Platform - Secrets Configuration
# IMPORTANT: Update GEMINI_API_KEY with your actual API key before deploying

---
# Main application secrets - homeguard-apps namespace
apiVersion: v1
kind: Secret
metadata:
  name: homeguard-secrets
  namespace: homeguard-apps
  labels:
    app: homeguard
type: Opaque
stringData:
  # PostgreSQL (User Service)
  POSTGRES_HOST: "postgresql.homeguard-data"
  POSTGRES_PORT: "5432"
  POSTGRES_USER: "postgres"
  POSTGRES_PASSWORD: "homeguard-postgres-2024"
  POSTGRES_DB: "homeguard"
  POSTGRES_URL: "postgresql://postgres:homeguard-postgres-2024@postgresql.homeguard-data:5432/homeguard?sslmode=disable"

  # TimescaleDB (Analytics Service)
  TIMESCALE_HOST: "timescaledb.homeguard-data"
  TIMESCALE_PORT: "5432"
  TIMESCALE_USER: "postgres"
  TIMESCALE_PASSWORD: "homeguard-timescale-2024"
  TIMESCALE_DB: "analytics"
  TIMESCALE_URL: "postgresql://postgres:homeguard-timescale-2024@timescaledb.homeguard-data:5432/analytics?sslmode=disable"

  # MongoDB (Device Service, Agent Memory)
  MONGO_HOST: "mongodb.homeguard-data"
  MONGO_PORT: "27017"
  MONGO_USER: "root"
  MONGO_PASSWORD: "homeguard-mongo-2024"
  MONGO_DB: "homeguard"
  MONGO_URL: "mongodb://root:homeguard-mongo-2024@mongodb.homeguard-data:27017/homeguard?authSource=admin"

  # Redis (Cache, Pub/Sub)
  REDIS_HOST: "redis-master.homeguard-data"
  REDIS_PORT: "6379"
  REDIS_PASSWORD: "homeguard-redis-2024"
  REDIS_URL: "redis://:homeguard-redis-2024@redis-master.homeguard-data:6379"

  # ScyllaDB (Event Store)
  SCYLLA_HOSTS: "scylladb.homeguard-data"
  SCYLLA_PORT: "9042"
  SCYLLA_KEYSPACE: "iot_events"

  # Kafka
  KAFKA_BROKERS: "homeguard-kafka-kafka-bootstrap.homeguard-messaging:9092"

  # Internal Service URLs
  USER_SERVICE_URL: "http://user-service.homeguard-apps:8080"
  DEVICE_SERVICE_URL: "http://device-service.homeguard-apps:8080"
  DEVICE_INGEST_URL: "http://device-ingest.homeguard-apps:8080"
  EVENT_PROCESSOR_URL: "http://event-processor.homeguard-apps:8080"
  NOTIFICATION_SERVICE_URL: "http://notification-service.homeguard-apps:8080"
  ANALYTICS_SERVICE_URL: "http://analytics-service.homeguard-apps:8080"
  SCENARIO_ENGINE_URL: "http://scenario-engine.homeguard-apps:8080"

  # AI Services
  MCP_SERVER_URL: "http://mcp-server.homeguard-ai:8080"
  ANOMALY_SERVICE_URL: "http://anomaly-ml.homeguard-ai:8080"
  AGENTIC_AI_URL: "http://agentic-ai.homeguard-ai:8080"

  # n8n Webhooks
  N8N_BASE_URL: "http://n8n.homeguard-automation:5678"
  N8N_WEBHOOK_BASE: "http://n8n.homeguard-automation:5678/webhook"

  # JWT Configuration
  JWT_SECRET: "homeguard-jwt-secret-change-in-production-2024-very-long-key"
  JWT_EXPIRY: "24h"
  JWT_ISSUER: "homeguard-api"

  # API Gateway
  RATE_LIMIT_REQUESTS_PER_MINUTE: "100"
  RATE_LIMIT_BURST: "20"

  # Google Gemini API (Beta Endpoint)
  # Endpoint: https://generativelanguage.googleapis.com/v1beta/models/{MODEL}:generateContent?key={KEY}
  GEMINI_TEXT_API_KEY: "${GEMINI_TEXT_API_KEY}"
  GEMINI_VISION_API_KEY: "${GEMINI_VISION_API_KEY}"
  GEMINI_TEXT_MODEL: "${GEMINI_TEXT_MODEL}"
  GEMINI_VISION_MODEL: "${GEMINI_VISION_MODEL}"

  # Feature Flags
  ENABLE_AI_AGENT: "true"
  ENABLE_ANOMALY_DETECTION: "true"
  ENABLE_DEMO_MODE: "true"
  ENABLE_METRICS: "true"

---
# AI namespace secrets
apiVersion: v1
kind: Secret
metadata:
  name: homeguard-secrets
  namespace: homeguard-ai
  labels:
    app: homeguard
type: Opaque
stringData:
  # MongoDB for agent memory
  MONGO_URL: "mongodb://root:homeguard-mongo-2024@mongodb.homeguard-data:27017/homeguard?authSource=admin"

  # Redis for caching
  REDIS_URL: "redis://:homeguard-redis-2024@redis-master.homeguard-data:6379"

  # ScyllaDB for event queries
  SCYLLA_HOSTS: "scylladb.homeguard-data"
  SCYLLA_KEYSPACE: "iot_events"

  # TimescaleDB for analytics
  TIMESCALE_URL: "postgresql://postgres:homeguard-timescale-2024@timescaledb.homeguard-data:5432/analytics?sslmode=disable"

  # Kafka
  KAFKA_BROKERS: "homeguard-kafka-kafka-bootstrap.homeguard-messaging:9092"

  # Internal services
  DEVICE_SERVICE_URL: "http://device-service.homeguard-apps:8080"
  NOTIFICATION_SERVICE_URL: "http://notification-service.homeguard-apps:8080"
  N8N_WEBHOOK_BASE: "http://n8n.homeguard-automation:5678/webhook"

  # Google Gemini API (Beta Endpoint)
  GEMINI_TEXT_API_KEY: "${GEMINI_TEXT_API_KEY}"
  GEMINI_VISION_API_KEY: "${GEMINI_VISION_API_KEY}"
  GEMINI_TEXT_MODEL: "${GEMINI_TEXT_MODEL}"
  GEMINI_VISION_MODEL: "${GEMINI_VISION_MODEL}"

---
# Grafana datasource secrets
apiVersion: v1
kind: Secret
metadata:
  name: grafana-datasources
  namespace: homeguard-observability
  labels:
    app: homeguard
type: Opaque
stringData:
  # PostgreSQL datasource
  POSTGRES_URL: "postgresql://postgres:homeguard-postgres-2024@postgresql.homeguard-data:5432/homeguard?sslmode=disable"
  TIMESCALE_URL: "postgresql://postgres:homeguard-timescale-2024@timescaledb.homeguard-data:5432/analytics?sslmode=disable"
